{
  "jsonSchema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "WebSphere PMI collector configuration",
    "type": "object",
    "properties": {
      "update_every": {
        "title": "Update every",
        "description": "Data collection interval in seconds.",
        "type": "integer",
        "minimum": 1,
        "default": 5
      },
      "url": {
        "title": "PMI URL",
        "description": "WebSphere PerfServlet URL (e.g., http://localhost:9080/wasPerfTool/servlet/perfservlet)",
        "type": "string",
        "default": ""
      },
      "username": {
        "title": "Username",
        "description": "Username for HTTP authentication (if required)",
        "type": "string",
        "default": ""
      },
      "password": {
        "title": "Password",
        "description": "Password for HTTP authentication (if required)",
        "type": "string",
        "default": ""
      },
      "pmi_stats_type": {
        "title": "PMI statistics type",
        "description": "Level of PMI statistics to collect",
        "type": "string",
        "enum": ["basic", "extended", "all", "custom"],
        "default": "extended"
      },
      "pmi_refresh_rate": {
        "title": "PMI refresh rate",
        "description": "How often to refresh PMI statistics (seconds)",
        "type": "integer",
        "minimum": 10,
        "default": 60
      },
      "timeout": {
        "title": "HTTP timeout",
        "description": "Timeout for HTTP requests in seconds",
        "type": "integer",
        "minimum": 1,
        "default": 5
      },
      "cluster_name": {
        "title": "Cluster name",
        "description": "Name of the WebSphere cluster (for labeling)",
        "type": "string",
        "default": ""
      },
      "cell_name": {
        "title": "Cell name",
        "description": "Name of the WebSphere cell (for labeling)",
        "type": "string",
        "default": ""
      },
      "node_name": {
        "title": "Node name",
        "description": "Name of the WebSphere node (for labeling)",
        "type": "string",
        "default": ""
      },
      "server_type": {
        "title": "Server type",
        "description": "Type of WebSphere server",
        "type": "string",
        "enum": ["app_server", "dmgr", "nodeagent"],
        "default": "app_server"
      },
      "collect_jvm_metrics": {
        "title": "Collect JVM metrics",
        "description": "Enable collection of JVM metrics (heap, GC, threads)",
        "type": "boolean",
        "default": true
      },
      "collect_threadpool_metrics": {
        "title": "Collect thread pool metrics",
        "description": "Enable collection of thread pool metrics",
        "type": "boolean",
        "default": true
      },
      "collect_jdbc_metrics": {
        "title": "Collect JDBC metrics",
        "description": "Enable collection of JDBC connection pool metrics",
        "type": "boolean",
        "default": true
      },
      "collect_jca_metrics": {
        "title": "Collect JCA metrics",
        "description": "Enable collection of JCA connection pool metrics",
        "type": "boolean",
        "default": true
      },
      "collect_jms_metrics": {
        "title": "Collect JMS metrics",
        "description": "Enable collection of JMS destination metrics",
        "type": "boolean",
        "default": true
      },
      "collect_webapp_metrics": {
        "title": "Collect web app metrics",
        "description": "Enable collection of web application metrics",
        "type": "boolean",
        "default": true
      },
      "collect_session_metrics": {
        "title": "Collect session metrics",
        "description": "Enable collection of HTTP session metrics",
        "type": "boolean",
        "default": true
      },
      "collect_transaction_metrics": {
        "title": "Collect transaction metrics",
        "description": "Enable collection of transaction manager metrics",
        "type": "boolean",
        "default": true
      },
      "collect_cluster_metrics": {
        "title": "Collect cluster metrics",
        "description": "Enable collection of cluster member metrics",
        "type": "boolean",
        "default": true
      },
      "collect_servlet_metrics": {
        "title": "Collect servlet metrics",
        "description": "Enable collection of servlet metrics (APM)",
        "type": "boolean",
        "default": false
      },
      "collect_ejb_metrics": {
        "title": "Collect EJB metrics",
        "description": "Enable collection of EJB metrics (APM)",
        "type": "boolean",
        "default": false
      },
      "collect_jdbc_advanced": {
        "title": "Collect advanced JDBC metrics",
        "description": "Enable collection of advanced JDBC metrics",
        "type": "boolean",
        "default": false
      },
      "max_threadpools": {
        "title": "Max thread pools",
        "description": "Maximum number of thread pools to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 50
      },
      "max_jdbc_pools": {
        "title": "Max JDBC pools",
        "description": "Maximum number of JDBC pools to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 50
      },
      "max_jca_pools": {
        "title": "Max JCA pools",
        "description": "Maximum number of JCA pools to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 50
      },
      "max_jms_destinations": {
        "title": "Max JMS destinations",
        "description": "Maximum number of JMS destinations to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 50
      },
      "max_applications": {
        "title": "Max applications",
        "description": "Maximum number of applications to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 100
      },
      "max_servlets": {
        "title": "Max servlets",
        "description": "Maximum number of servlets to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 50
      },
      "max_ejbs": {
        "title": "Max EJBs",
        "description": "Maximum number of EJBs to collect (0 = unlimited)",
        "type": "integer",
        "minimum": 0,
        "default": 50
      },
      "collect_apps_matching": {
        "title": "Application filter",
        "description": "Only collect metrics for applications matching this pattern (supports wildcards)",
        "type": "string",
        "default": ""
      },
      "collect_pools_matching": {
        "title": "Pool filter",
        "description": "Only collect metrics for pools matching this pattern (supports wildcards)",
        "type": "string",
        "default": ""
      },
      "collect_jms_matching": {
        "title": "JMS filter",
        "description": "Only collect metrics for JMS destinations matching this pattern (supports wildcards)",
        "type": "string",
        "default": ""
      },
      "collect_servlets_matching": {
        "title": "Servlet filter",
        "description": "Only collect metrics for servlets matching this pattern (supports wildcards)",
        "type": "string",
        "default": ""
      },
      "collect_ejbs_matching": {
        "title": "EJB filter",
        "description": "Only collect metrics for EJBs matching this pattern (supports wildcards)",
        "type": "string",
        "default": ""
      },
      "vnode": {
        "title": "Virtual node",
        "description": "Virtual node identifier for configuration management",
        "type": "string",
        "default": ""
      },
      "pmi_custom_stats_paths": {
        "title": "Custom PMI paths",
        "description": "Array of specific PMI paths to collect when using custom stats type",
        "type": "array",
        "items": {
          "type": "string"
        },
        "default": []
      },
      "custom_labels": {
        "title": "Custom labels",
        "description": "Additional labels to add to all metrics",
        "type": "object",
        "additionalProperties": {
          "type": "string"
        },
        "default": {}
      }
    },
    "required": ["url"],
    "additionalProperties": false,
    "patternProperties": {
      "^name$": {}
    }
  },
  "uiSchema": {
    "uiOptions": {
      "fullPage": true
    },
    "password": {
      "ui:widget": "password"
    },
    "ui:flavour": "tabs",
    "ui:options": {
      "tabs": [
        {
          "title": "Base",
          "fields": [
            "update_every",
            "url",
            "username",
            "password",
            "timeout"
          ]
        },
        {
          "title": "PMI Settings",
          "fields": [
            "pmi_stats_type",
            "pmi_refresh_rate",
            "pmi_custom_stats_paths"
          ]
        },
        {
          "title": "Identity",
          "fields": [
            "cluster_name",
            "cell_name",
            "node_name",
            "server_type",
            "custom_labels",
            "vnode"
          ]
        },
        {
          "title": "Collection",
          "fields": [
            "collect_jvm_metrics",
            "collect_threadpool_metrics",
            "collect_jdbc_metrics",
            "collect_jca_metrics",
            "collect_jms_metrics",
            "collect_webapp_metrics",
            "collect_session_metrics",
            "collect_transaction_metrics",
            "collect_cluster_metrics"
          ]
        },
        {
          "title": "APM",
          "fields": [
            "collect_servlet_metrics",
            "collect_ejb_metrics",
            "collect_jdbc_advanced"
          ]
        },
        {
          "title": "Limits",
          "fields": [
            "max_threadpools",
            "max_jdbc_pools",
            "max_jca_pools",
            "max_jms_destinations",
            "max_applications",
            "max_servlets",
            "max_ejbs"
          ]
        },
        {
          "title": "Filters",
          "fields": [
            "collect_apps_matching",
            "collect_pools_matching",
            "collect_jms_matching",
            "collect_servlets_matching",
            "collect_ejbs_matching"
          ]
        }
      ]
    }
  }
}